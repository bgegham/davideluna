$(document).ready(function(){function e(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(t){$(e).parents(".custom-input-file").css("background-image","url("+t.target.result+")")},t.readAsDataURL(e.files[0])}}$(".sortPriority").bind("click",function(){$(".sortable").sortable({connectWith:".office-sort"}).disableSelection(),$(this).hide(),$(".savePriority").show()}),$(".savePriority").bind("click",function(){var e=[],t=$(".sortable").find("div[data-priority]");$.each(t,function(t,n){e.push($(n).attr("data-priority").replace(/\"/g,""))}),$.ajax({type:"POST",url:"/control/admin/offices/priority",dataType:"json",data:{priority:e},success:function(){document.location.reload()},error:function(){document.location.reload()}}),$(this).hide(),$(".sortPriority").show()}),$(".removeOffice").bind("click",function(){var e=$(this).attr("data-remove").replace(/\"/g,"");e&&confirm("Are you sure?")&&$.ajax({type:"POST",url:"/control/admin/offices/remove",dataType:"json",data:{id:e},success:function(){document.location.reload()},error:function(){document.location.reload()}})}),$(".change-file-input").change(function(){e(this)}),$("#addClient").bind("click",function(){{var e=($("#clientsControl").find(".client-on-line").length,$("<div>").addClass("row client-on-line")),t=$("<div>").addClass("col-xs-3"),n=($("<label>").html("Name en").appendTo(t),$("<input>").addClass("form-control").attr("name","client_name_en").attr("type","text").attr("placeholder","English").attr("required","required").appendTo(t),$("<div>").addClass("col-xs-3")),a=($("<label>").html("Name rus").appendTo(n),$("<input>").addClass("form-control").attr("name","client_name_ru").attr("type","text").attr("placeholder","Русский").attr("required","required").appendTo(n),$("<div>").addClass("col-xs-3")),i=($("<label>").html("Image file").appendTo(a),$("<div>").addClass("input-group").appendTo(a)),o=($("<label>").addClass("input-group-btn").html("<span class='btn btn-primary'>Browse&hellip;<input name='client_image' class='client-image' required='required' type='file' style='display: none;'></span>").appendTo(i),$("<input>").addClass("form-control nameShow").attr("type","text").attr("readonly","readonly").appendTo(i),$("<div>").addClass("col-xs-3"));$("<img>").addClass("image-show-clients").appendTo(o),$("<button>").attr("type","button").addClass("btn btn-xs btn-danger").html("<i class='fa fa-remove'><i>").appendTo(o).attr("style","margin-left: 30px;margin-top: 18px").click(function(){$(this).parents("div.client-on-line").remove()}),$("<span>").attr("type","button").addClass("btn btn-xs btn-info sort-clients").html("<i class='fa fa-bars'><i>").attr("style","margin-left: 10px;margin-top: 18px;cursor:move;").appendTo(o)}t.appendTo(e),n.appendTo(e),a.appendTo(e),o.appendTo(e);var l=$($("<input type='hidden' value='new' name='old_client_id'>"));l.appendTo(e),e.appendTo($("#clientsControl")),$(".sortable-clients").sortable({connectWith:".client-on-line",handle:"span.sort-clients"}).disableSelection()}),$(".remove-old-client").on("click",function(){var e=$(this).attr("data-client-id").replace(/\"/g,"");console.log(e),$("#editForm").append("<input type='hidden' name='client_remove' value='"+e+"'/>"),$(this).parents("div.client-on-line").remove()}),$(document).on("change",".client-image",function(){var e=$(this),n=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.parents("div.input-group").find("input.nameShow").val(n),t(this,e.parents("div.client-on-line").find("img.image-show-clients"))});var t=function(e,t){if(e.files){var n=e.files.length;for(i=0;i<n;i++){var a=new FileReader;a.onload=function(e){t.attr("src",e.target.result)},a.readAsDataURL(e.files[i])}}}});