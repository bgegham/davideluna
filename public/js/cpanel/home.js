$(document).ready(function(){var t=$("#homeContent");$.ajax({type:"GET",url:"/control/admin/home/json",success:function(a){if(0==a.content.length)$("<h2 id='emptyData' class='text-center'>Create first element</h2>").appendTo(t),$("#saveFormJson").hide();else{var e=a.content;e.forEach(function(a){switch(a.node){case"text":var e=$($("<div>")).addClass(a.className).attr("id",a.id).attr("data-layout",a.layout).attr("data-node",a.node).attr("data-asterisk",a.asterisk).attr("data-bold",a.styles.bold).attr("data-alignment",a.styles.textAlign).attr("data-family",a.styles.fontFamily).fadeIn("fast"),n="header"==a.styles.bold||"all"==a.styles.bold?600:100,o="all"==a.styles.bold?600:100,l="font-weight:"+n+";font-family:"+a.styles.fontFamily+";text-align:"+a.styles.textAlign+";",r="font-weight:"+o+";font-family:"+a.styles.fontFamily+";text-align:"+a.styles.textAlign+";",i=$("<input name='eng' style='"+l+"' value='"+a.elements.valueHeader.en+"' placeholder='eng' class='form-control width-6 el-header' type='text'><input name='rus' style='"+l+"' value='"+a.elements.valueHeader.ru+"' placeholder='rus' class='form-control width-6 el-header' type='text'><textarea rows='4' style='"+r+"' name='eng' placeholder='eng' class='form-control width-6'>"+a.elements.valueMain.en+"</textarea><textarea rows='4' style='"+r+"' name='rus' placeholder='rus' class='form-control width-6'>"+a.elements.valueMain.ru+"</textarea>"),d=s("text-edit-mod");d.appendTo(e),i.appendTo(e),e.appendTo(t);break;case"hr":var e=$($("<div>")).addClass(a.className).attr("id",a.id).attr("data-layout",a.layout).attr("data-node",a.node).fadeIn("fast"),d=s("text-line-mod"),i=$("<hr/>");d.appendTo(e),i.appendTo(e),e.appendTo(t);break;case"space":var e=$($("<div>")).addClass(a.className).attr("id",a.id).attr("data-layout",a.layout).attr("data-node",a.node).attr("data-height",a.styles.height).attr("style","height:"+a.styles.height+"px").fadeIn("fast"),d=s("divider-space-mod");d.appendTo(e),e.appendTo(t)}}),setTimeout(function(){l()},200)}},error:function(){window.location.href="/control/admin/oauth/login"}});var a=$("#editModalText"),e=$("#editModalDivLine"),n=$("#editModalDivSpace"),o=function(){$("#addNew").modal("hide"),l()};a.bind("hide",function(){l()});var l=function(){$(".sortable-row").sortable({connectWith:".sortable-row",handle:"span.el-move"}).disableSelection(),$("#emptyData").hide(),$("#saveFormJson").show()},r=function(t,e,n,o,l,r){a.attr("data-toggle-col",e),a.find(t).click(),"false"==n?a.find("#asteriskStatus").removeAttr("checked"):a.find("#asteriskStatus").prop("checked",!0),a.find("input[name='text-bold']").each(function(){$(this).val()==o&&$(this).click()}),a.find("input[name='text-alignment']").each(function(){$(this).val()==l&&$(this).click()}),a.find("input[name='text-font-family']").each(function(){$(this).val()==r&&$(this).click()}),a.modal("show")},i=function(t,a){e.attr("data-toggle-col",a),e.find(t).click(),e.modal("show")},d=function(t,a,e){n.attr("data-toggle-col",a),n.find(t).click(),n.find("#spaceHeight").val(e),n.modal("show")},s=function(t){return $("<div class='el-control-actions'><span class='fa fa-remove el-remove pull-right' title='Remove'></span><span class='fa fa-edit el-edit pull-right "+t+"' title='Edit'></span><span class='fa fa-arrows-alt el-move pull-right' title='Sort'></span></div>")},c=function(){return"_id_"+Math.floor(9954151998462e4*Math.random())};$(".element-text").bind("click",function(){var a=$("<div class='col-xs-12 el-create-sort' data-layout='12' data-asterisk='true' data-bold='header' data-alignment='left' data-family='default' data-node='text' id='"+c()+"'></div>"),e=$("<input name='eng' placeholder='eng' class='form-control width-6 el-header' type='text'><input name='rus' placeholder='rus' class='form-control width-6 el-header' type='text'><textarea rows='4' name='eng' placeholder='eng' class='form-control width-6'></textarea><textarea rows='4' name='rus' placeholder='rus' class='form-control width-6'></textarea>"),n=s("text-edit-mod");n.appendTo(a),e.appendTo(a),a.appendTo(t),o()}),$(".element-divider").bind("click",function(){var a=$("<div class='col-xs-12 el-create-sort' data-layout='12' data-node='hr' id='"+c()+"'></div>"),e=s("divider-line-mod"),n=$("<hr/>");e.appendTo(a),n.appendTo(a),a.appendTo(t),o()}),$(".element-space").bind("click",function(){var a=$("<div class='col-xs-12 el-create-sort' data-layout='12' data-height='50' data-node='space' id='"+c()+"'></div>"),e=s("divider-space-mod");e.appendTo(a),a.appendTo(t),o()}),$(document).on("click","span.text-edit-mod",function(t){t.preventDefault();var a=$(this),e=a.parents("div.el-create-sort"),n="#layout1",o=e.attr("data-layout");"6"==o&&(n="#layout2");var l=e.attr("id"),i="true";"false"===e.attr("data-asterisk")&&(i="false");var d="header";"all"===e.attr("data-bold")&&(d="all"),"none"===e.attr("data-bold")&&(d="none");var s="left";"center"===e.attr("data-alignment")&&(s="center"),"right"===e.attr("data-alignment")&&(s="right"),"justify"===e.attr("data-alignment")&&(s="justify");var c="default";"default"!==e.attr("data-family")&&(c="custom"),r(n,l,i,d,s,c)}),$(document).on("click","span.divider-line-mod",function(t){t.preventDefault();var a=$(this),e=a.parents("div.el-create-sort"),n=".layout1",o=e.attr("data-layout");"6"==o&&(n=".layout2");var l=e.attr("id");i(n,l)}),$(document).on("click","span.divider-space-mod",function(t){t.preventDefault();var a=$(this),e=a.parents("div.el-create-sort"),n=".layout1",o=e.attr("data-layout");"6"==o&&(n=".layout2");var l=e.attr("data-height"),r=e.attr("id");d(n,r,l)}),$(document).on("click","label.layout-btn",function(t){t.preventDefault();var a=$(this),e=a.parents("div.modal").attr("data-toggle-col"),n=a.find("input").attr("data-class-name"),o=$("#"+e);o.attr("class",""),o.addClass(n+" col-xs-12 el-create-sort"),o.attr("data-layout",a.find("input").attr("value"))}),$(document).on("click","input#asteriskStatus",function(){var t=$(this),a=t.parents("div.modal").attr("data-toggle-col"),e=t.prop("checked"),n=$("#"+a);n.attr("data-asterisk",e)}),$(document).on("change","input#spaceHeight",function(){var t=$(this),a=t.parents("div.modal").attr("data-toggle-col"),e=t.val(),n=$("#"+a);n.css({height:e+"px"}),n.attr("data-height",e)}),$(document).on("click","input[name='text-bold']",function(){var t=$(this),a=t.parents("div.modal").attr("data-toggle-col"),e=t.val(),n=$("#"+a);n.attr("data-bold",e),"header"==e&&(n.find("input.form-control").css({"font-weight":600}),n.find("textarea.form-control").css({"font-weight":100})),"all"==e&&(n.find("input.form-control").css({"font-weight":600}),n.find("textarea.form-control").css({"font-weight":600})),"none"==e&&(n.find("input.form-control").css({"font-weight":100}),n.find("textarea.form-control").css({"font-weight":100}))}),$(document).on("click","input[name='text-alignment']",function(){var t=$(this),a=t.parents("div.modal").attr("data-toggle-col"),e=t.val(),n=$("#"+a);n.attr("data-alignment",e),"left"==e&&n.find(".form-control").css({"text-align":"left"}),"center"==e&&n.find(".form-control").css({"text-align":"center"}),"right"==e&&n.find(".form-control").css({"text-align":"right"}),"justify"==e&&n.find(".form-control").css({"text-align":"justify"})}),$(document).on("click","input[name='text-font-family']",function(){var t=$(this),a=t.parents("div.modal").attr("data-toggle-col"),e=t.val(),n=$("#"+a);n.attr("data-family",e),"default"==e&&n.find("input.form-control").css({"font-family":""}),"custom"==e&&n.find("input.form-control").css({"font-family":"custom"})}),$(document).on("click","span.el-remove",function(t){t.preventDefault(),confirm("Are you sure?")&&$(this).parents(".el-create-sort").remove()}),$("#saveFormJson").bind("click",function(a){a.preventDefault();var e=[],n=t.find(".el-create-sort");n.each(function(){var t=$(this);switch(t.attr("data-node")){case"text":e.push({node:t.attr("data-node"),id:t.attr("id"),layout:t.attr("data-layout"),className:t.attr("class"),asterisk:t.attr("data-asterisk"),styles:{bold:t.attr("data-bold"),textAlign:t.attr("data-alignment"),fontFamily:t.attr("data-family")},elements:{valueHeader:{en:t.find("input[name='eng']").val(),ru:t.find("input[name='rus']").val()},valueMain:{en:t.find("textarea[name='eng']").val(),ru:t.find("textarea[name='rus']").val()}}});break;case"hr":e.push({node:t.attr("data-node"),id:t.attr("id"),layout:t.attr("data-layout"),className:t.attr("class"),styles:null,elements:{hr:"hr"}});break;case"space":e.push({node:t.attr("data-node"),id:t.attr("id"),layout:t.attr("data-layout"),className:t.attr("class"),styles:{height:t.attr("data-height")},elements:null})}}),setTimeout(function(){$.ajax({type:"POST",url:"/control/admin/home",dataType:"json",data:{data:e},success:function(){document.location.reload()},error:function(){document.location.reload()}})},100)})});